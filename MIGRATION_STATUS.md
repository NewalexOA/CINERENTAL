# Статус миграции фронтенда

Этот документ описывает цели, принципы и текущий статус миграции фронтенда приложения на новый технологический стек.

## 1. Изначальная задача

Основная задача — **полная и безопасная миграция фронтенда** с текущего стека (шаблоны Jinja2, Bootstrap, нативный JavaScript) на современный SPA-фреймворк: **React** с **TypeScript** и библиотекой компонентов **shadcn/ui**.

### Ключевые принципы и ограничения

Миграция проводится со строгим соблюдением следующих правил:

1.  **Максимальное сохранение UX и бизнес-логики.**
    *   Для конечного пользователя (сотрудника) это должно выглядеть как редизайн, а не как новая программа. Все привычные действия, кнопки и процессы должны остаться на своих местах.
    *   Критически важно сохранить всю бизнес-логику. Как указано в `docs/техническое_задание.md`: *"система поддерживает создание проектов с множественными бронированиями и разными датами для отдельного оборудования"*. Именно этот принцип является ключевым при переносе модуля "Проекты".

2.  **Минималистичный и компактный UI.**
    *   Интерфейс должен быть утилитарным, как у профессионального софта. Цель — высокая плотность данных и использование всего пространства экрана, а не "воздушный" дизайн.

3.  **Безопасная и поэтапная миграция.**
    *   Новый фронтенд разрабатывается параллельно в папке `frontend-react`, не затрагивая работающую версию.
    *   Страницы переносятся по одной, с полным функциональным покрытием, что позволяет постоянно тестировать и быть уверенным в качестве каждого шага.

---

## 2. Статус миграции

### I. Завершенные этапы

На данный момент полностью завершен перенос следующих модулей:

1.  **Фундамент приложения:**
    *   Создан новый проект на **React + TypeScript + Vite**.
    *   Настроен **TailwindCSS** и базовые компоненты **shadcn/ui** (`Button`, `Dialog`, `Input`, `Select` и т.д.) для единого стиля.
    *   Настроена маршрутизация и основной макет приложения с боковым меню.

2.  **Модуль «Клиенты» (`/clients`):**
    *   **Функционал полностью перенесен.** Реализован поиск, сортировка (по имени, дате, кол-ву бронирований) и переключение вида "список/сетка".
    *   Реализованы модальные окна для **создания, редактирования и удаления** клиентов с валидацией форм.

3.  **Модуль «Категории» (`/categories`):**
    *   **Функционал полностью перенесен.** Реализована таблица категорий с информацией о количестве оборудования.
    *   Воспроизведена ключевая особенность — **управление иерархией** через модальное окно "Подкатегории".
    *   Реализовано **визуальное отображение вложенности** (отступы) во всех выпадающих списках.

4.  **Модуль «Оборудование» (`/equipment`):**
    *   Полностью реализован **режим просмотра списка** с пагинацией, поиском и фильтрацией.
    *   Реализовано **полное управление (CRUD)**: создание, редактирование и удаление оборудования через модальные окна.

5.  **Модуль «Сканер» (`/scanner`):**
    *   Реализована **базовая логика сканирования** (HID-сканер, ручной ввод) с запросом информации о товаре с сервера.
    *   Отсканированные товары добавляются в **локальную сессию** (аналог *"Сессии сканирования"* из `docs/техническое_задание.md`).
    *   Реализована ключевая связка: по кнопке "Создать проект" товары из сессии **переносятся в корзину** и происходит переход на страницу создания нового проекта.

---

### II. Текущий этап: Модуль «Проекты» (Создание)

Сейчас я работаю над страницей **создания нового проекта (`NewProjectPage.tsx`)**. Это самый сложный этап из-за комплексной бизнес-логики, связанной с корзиной и проверкой доступности.

**Что я делаю прямо сейчас в этом файле:**

1.  **Интерфейс:** Построен двухпанельный интерфейс:
    *   **Слева:** Форма с деталями проекта (название, клиент, глобальные даты) и сама корзина (список добавленного оборудования).
    *   **Справа:** Каталог оборудования (`EquipmentPicker`) для поиска и добавления позиций в корзину.

2.  **Бизнес-логика (в процессе):**
    *   Я реализую возможность задавать **индивидуальные даты бронирования для каждой позиции** в корзине.
    *   Я добавляю кнопку **"Применить даты проекта ко всем"**, которая запускает **проверку доступности** (`availability check`) для каждого товара на сервере, прежде чем применить даты. Это предотвращает случайное добавление уже забронированного оборудования.
    *   При создании проекта на сервер отправляется корректно сформированный список бронирований (`bookings`) с индивидуальными датами для каждой позиции, используя `POST /bookings/batch` эндпоинт.

### III. Следующие шаги

Сразу после завершения и тестирования страницы создания проекта, я перейду к последнему крупному этапу — странице **просмотра и редактирования уже существующего проекта**. Она будет основана на шаблоне `projects/view.html` и будет включать такие функции, как добавление оборудования в существующий проект, изменение статусов и печать документов.
