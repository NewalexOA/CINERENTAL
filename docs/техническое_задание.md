# Техническое задание на систему управления арендой кинооборудования

## 1. Описание системы
Система предназначена для управления арендой кинооборудования. Она позволит менеджерам контролировать доступность и бронирование оборудования, управлять состоянием заказов и следить за состоянием возврата оборудования. Клиенты не имеют доступа к программе и не могут выбирать оборудование для бронирования.

## 2. Основные сущности
- **Оборудование**: Каждое оборудование (камеры, объективы, аксессуары) будет хранить характеристики: название, штрих-код (или QR-код), серийный номер, состояние (например, "в наличии", "в аренде", "в ремонте"), стоимость аренды за сутки. Оборудование организовано в иерархическую систему категорий и подкатегорий.
- **Категории оборудования**: Древовидная структура категорий с возможностью создания неограниченного количества уровней вложенности. Управление категориями доступно через интерфейс системы.
- **Клиенты**: Клиенты не имеют доступа к программе. Информация о клиенте будет храниться для назначения аренды. Система хранит полную историю аренд для каждого клиента.
- **Бронирования**: Менеджер подбирает оборудование для аренды и устанавливает дату начала и окончания аренды. Каждое бронирование может включать несколько единиц оборудования.

## 3. Механизм бронирования
- Менеджер подбирает комплект оборудования (по одному или нескольким единицам), указывает контактные данные клиента и выбирает даты аренды.
- Для каждого оборудования создается запись о бронировании, где указываются даты начала и окончания бронирования.
- Проверка доступности: система проверяет, нет ли пересечений с другими бронированиями на выбранные даты для каждого оборудования.
- Статус бронирования может быть "черновик", "активно" или "завершено". "Активное" оборудование будет "занято" на выбранные даты и не доступно для повторного бронирования в этот период.
- После бронирования оборудование блокируется на указанные даты, но в дальнейшем можно изменять или отменять бронирование.
- Нужна возможность добавлять позиции к бронированию с другими датами аренды. То есть например, основной список забронирован на 2025-03-10 - 2025-03-30, а поздее в этот же список нужно добавить одну или несколько позиций с датами 2025-03-12 - 2025-04-05.

## 4. Система возврата оборудования
- Менеджер откроет заказ и начнёт сканировать возвращаемое оборудование, каждое из которых будет отмечено как "возвращённое" в системе.
- Поддерживается частичный возврат оборудования: единицы оборудования из одного заказа могут быть возвращены в разное время.
- Система отслеживает статус возврата для каждой единицы оборудования в заказе.
- Заказ считается полностью завершённым только после возврата всех единиц оборудования.

## 5. Интерфейс и функционал для менеджера
- Менеджеры имеют доступ к полному функционалу.
- Интерфейс с возможностью управления бронированиями, выдачей оборудования, созданием и редактированием заказов.
- Сканирование штрих-кодов осуществляется через специальный сканер, работающий в режиме HID (эмуляция клавиатуры).
- Время отклика при сканировании и поиске оборудования в базе данных не должно превышать 1 секунды.
- Создание отчётов не требуется для MVP, будет реализовано позже.

## 6. Технологический стек
- **Backend**: Python (например, Django или FastAPI).
- **Frontend**: Bootstrap для интерфейса.
- **База данных**:
  - PostgreSQL для хранения данных
  - Redis для кеширования и ускорения работы с частыми запросами
  - Оптимизация для работы с объемом до 10 000 записей
  - Индексация полей для быстрого поиска по штрих-кодам
- **Докеризация**: Приложение будет работать локально в Docker-контейнере.

## 7. Данные в базе
- **Категории оборудования**:
  - ID категории
  - Название категории
  - ID родительской категории (null для корневых категорий)
  - Описание категории
- **Оборудование**:
  - ID, название, штрих-код, серийный номер, состояние
  - ID категории (связь с таблицей категорий)
  - Стоимость аренды за сутки
  - Дата последнего изменения стоимости
- **Клиенты**:
  - Обязательные поля:
    - ФИО
    - Контактный телефон
  - Дополнительные поля:
    - Email
    - Паспортные данные
    - Название компании
    - Адрес
    - Дополнительные контакты
  - История аренд:
    - Связь с таблицей бронирований
    - Возможность просмотра всех прошлых заказов
    - Статистика по своевременности возврата
- **Бронирования**:
  - ID оборудования, ID клиента, дата начала и окончания аренды, статус бронирования
  - Для каждой единицы оборудования:
    - Фактическая дата и время выдачи
    - Фактическая дата и время возврата
    - Индивидуальный статус ("забронировано", "выдано", "возвращено")
    - Стоимость аренды за период
  - Общая стоимость заказа
- **Сканирование**:
  - Каждое отсканированное оборудование будет обновлять статус в конкретном заказе как "выдано" или "возвращено".
- **Документы**:
  - Связаны с конкретным бронированием и клиентом
  - Типы документов:
    - Договор аренды
    - Акт приема-передачи оборудования
  - Хранение в виде файлов с привязкой к ID бронирования

## 8. План на будущее
- Внедрение автоматической отправки уведомлений (email, Telegram, SMS).
- Генерация документов для выдачи и приёма оборудования.
- Расширенные отчёты для анализа загрузки оборудования и финансов.
- Система скидок для постоянных клиентов
- Внедрение системы аутентификации и авторизации:
  - Разделение прав доступа (администраторы и менеджеры)
  - Аудит действий пользователей
  - Безопасное хранение учетных данных
  - Двухфакторная аутентификация
